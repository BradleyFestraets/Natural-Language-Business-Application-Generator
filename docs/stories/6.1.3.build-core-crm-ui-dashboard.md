
---
story_id: 6.1.3
epic_id: 6.1
title: "Build Core CRM UI Dashboard"
status: "Draft"
priority: "P0 (Critical - Unblocks CRM usability)"
estimate: "8 story points"
dev_agent: "TBD"
---

# Story 6.1.3: Build Core CRM UI Dashboard

**As a** Business User,
**I want** a central dashboard to view, search, and manage my customers,
**so that** I can have a single source of truth for all customer information.

## Story Overview

This story creates the primary user interface for the Customer Relationship Management (CRM) system. It involves building a main dashboard page that displays a searchable list of all customers and allows the user to click through to a detailed 360-degree view of a single customer. This story will consume the API endpoints created in story `6.1.2` and is the first step in making the CRM functional for users.

## Acceptance Criteria

- [ ] A new page is created at `client/src/pages/customer-dashboard.tsx` and is accessible from the main application navigation.
- [ ] The dashboard displays a table of customers, populated by data from the `GET /api/customers` endpoint.
- [ ] The customer table includes a search and filter component that uses the `POST /api/customers/search` endpoint to refine the list.
- [ ] Clicking on a customer in the table navigates the user to a detailed customer profile page.
- [ ] The customer profile page fetches and displays detailed information for a single customer from the `GET /api/customers/:id` endpoint, including their activity timeline.
- [ ] All new UI components are built using the project's established `Shadcn UI` and `Tailwind CSS` frameworks.
- [ ] All data fetching, caching, and server state management is handled using `React Query`.

## Tasks / Subtasks

- [ ] **Task 1: Set up CRM Page and Routing** (AC: 1)
    - [ ] Create the new page file: `client/src/pages/customer-dashboard.tsx`.
    - [ ] Add a route using `wouter` to make the new page accessible, e.g., at `/crm`.
    - [ ] Add a link to the main application navigation bar to access the CRM dashboard.

- [ ] **Task 2: Build Customer List Component** (AC: 2)
    - [ ] Create a reusable `CustomerTable` component in `client/src/components/crm/`.
    - [ ] Use the `useQuery` hook from `React Query` to fetch data from `GET /api/customers`.
    - [ ] Display the customer data in a table using `Shadcn UI` table components. Include columns for Name, Company, Email, Status, and Health Score.

- [ ] **Task 3: Build Customer Search Component** (AC: 3)
    - [ ] Create a `CustomerSearch` component in `client/src/components/crm/`.
    - [ ] Add input fields for search terms and filters (e.g., status, tags).
    - [ ] Use the `useMutation` hook from `React Query` to send search criteria to the `POST /api/customers/search` endpoint.
    - [ ] Update the `CustomerTable` with the results from the search.

- [ ] **Task 4: Build Customer Profile Page** (AC: 4, 5)
    - [ ] Create a dynamic route (e.g., `/crm/:id`) for viewing a single customer.
    - [ ] Create a `CustomerProfile` component in `client/src/components/crm/`.
    - [ ] On this page, use the customer ID from the URL to fetch data from `GET /api/customers/:id` and `GET /api/customers/:id/timeline`.
    - [ ] Display all relevant customer details, including their 360-degree view and activity timeline.

- [ ] **Task 5: Ensure Responsiveness** (AC: 6)
    - [ ] Ensure all new components and pages are fully responsive and usable on mobile devices.
    - [ ] Review the existing `MobileOptimizedCRM.tsx` component. If applicable, integrate its styles or logic into the new components to ensure a consistent mobile experience.

## Dev Notes

This is a foundational UI story. Adherence to the existing architecture and tech stack is critical.

-   **Tech Stack**: [Source: `docs/architecture.md`]
    -   **Framework**: React / Vite
    -   **UI Components**: Shadcn UI
    -   **Styling**: Tailwind CSS
    -   **State Management**: React Query for all server state.
    -   **Routing**: Wouter
-   **File Structure**: Create new components within `client/src/components/crm/` and the new page in `client/src/pages/`.
-   **API Endpoints**: This story consumes the endpoints defined in story `6.1.2`. The developer must have that story's context.
-   **Mobile UI**: The architect noted the existence of `client/src/components/MobileOptimizedCRM.tsx`. You should review this file. It may contain useful styling or logic for ensuring the new dashboard is mobile-friendly.

### Testing
-   **Testing Strategy**: Per `docs/architecture.md`, unit and component tests are required.
-   **Guidance**: Write component tests for `CustomerTable`, `CustomerSearch`, and `CustomerProfile`. Use a library like `msw` (Mock Service Worker) to mock the API responses to test how the components handle loading, success, and error states.

## Change Log

| Date       | Version | Description                 | Author       |
|------------|---------|-----------------------------|--------------|
| 2025-09-21 | 1.0     | Initial draft of UI story.  | Bob (Scrum Master) |
